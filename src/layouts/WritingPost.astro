---
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';
import { formatDate } from '../utils/formatDate';

type Props = CollectionEntry<'writing'>['data'];

const { title, description, pubDate, updatedDate, tags } = Astro.props;
---

<BaseLayout title={title} description={description}>
  <article class="prose prose-lg dark:prose-invert max-w-none">
    <header class="mb-8 not-prose">
      <h1 class="text-4xl font-bold mb-4">{title}</h1>
      <div class="flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400">
        <time datetime={pubDate.toISOString()}>
          {formatDate(pubDate)}
        </time>
        {updatedDate && (
          <span>
            (Updated: <time datetime={updatedDate.toISOString()}>{formatDate(updatedDate)}</time>)
          </span>
        )}
        {tags && tags.length > 0 && (
          <div class="flex gap-2">
            {tags.map((tag) => (
              <span style="background: var(--color-bg-secondary); color: var(--color-accent); border: 1px solid var(--color-border);" class="px-2.5 py-1 rounded text-xs font-medium">
                {tag}
              </span>
            ))}
          </div>
        )}
      </div>
    </header>
    <slot />
  </article>
  <div class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-800">
    <a href="/writing" class="text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400">
      ‚Üê Back to writing
    </a>
  </div>
</BaseLayout>

<style>
  article :global(h2) {
    font-size: 1.5rem;
    font-weight: 600;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  article :global(h3) {
    font-size: 1.25rem;
    font-weight: 600;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
  }

  article :global(p) {
    margin-bottom: 1rem;
  }

  article :global(ul), article :global(ol) {
    margin-bottom: 1rem;
    margin-left: 1.5rem;
  }

  article :global(li) {
    margin-bottom: 0.5rem;
  }

  article :global(code) {
    background-color: #f3f4f6;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
  }

  :root.dark article :global(code) {
    background-color: #1f2937;
  }

  article :global(pre) {
    background-color: #f3f4f6;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin-bottom: 1rem;
  }

  :root.dark article :global(pre) {
    background-color: #111827;
  }

  article :global(pre code) {
    background-color: transparent;
    padding: 0;
  }

  article :global(blockquote) {
    border-left: 4px solid #d1d5db;
    padding-left: 1rem;
    font-style: italic;
    margin: 1rem 0;
  }

  :root.dark article :global(blockquote) {
    border-left-color: #374151;
  }
</style>
