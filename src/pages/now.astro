---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { formatDate } from '../utils/formatDate';

const nowEntries = await getCollection('now');
const currentNowEntry = nowEntries[0];
const currentNow = currentNowEntry ? await currentNowEntry.render() : null;
---

<BaseLayout
  title="Now - Stephen McCullough"
  description="What Stephen McCullough is currently working on and focused on"
>
  <article class="prose prose-lg dark:prose-invert max-w-none space-y-8" style="color: var(--color-text);">
    <div class="space-y-4">
      <h1 style="color: var(--color-text-heading);">What I'm Doing Now</h1>

      <p style="color: var(--color-text-muted);" class="text-sm">
        Last updated: {currentNowEntry && formatDate(currentNowEntry.data.updatedDate)}
      </p>
    </div>

    <div class="space-y-5" style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
      {currentNow ? (
        <currentNow.Content />
      ) : (
        <p style="color: var(--color-text-secondary);">Check back soon for updates on what I'm currently working on.</p>
      )}
    </div>

    <hr style="border-color: var(--color-border);" />

    <p class="text-sm" style="color: var(--color-text-muted);">
      This is a <a href="https://nownownow.com/about" target="_blank" rel="noopener noreferrer" style="color: var(--color-accent);">"now" page</a>,
      inspired by Derek Sivers. It's a snapshot of what I'm focused on at this point in time.
    </p>
  </article>

  <style>
    article :global(h2),
    article :global(h3),
    article :global(h4) {
      color: var(--color-text-heading);
      font-family: 'Space Grotesk', sans-serif;
      margin-top: 0;
    }

    article :global(p) {
      color: var(--color-text);
      margin-bottom: 1.5rem;
      line-height: 1.8;
    }

    article :global(a) {
      color: var(--color-accent);
    }

    article :global(a:hover) {
      color: var(--color-accent-hover);
    }

    article :global(strong) {
      color: var(--color-text-heading);
    }

    article :global(code) {
      background-color: var(--color-surface);
      color: var(--color-accent-purple);
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-size: 0.9em;
    }
  </style>
</BaseLayout>
