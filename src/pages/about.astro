---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout
  title="About - Stephen McCullough"
  description="About Stephen McCullough, software engineer and founder from Northern Ireland"
>
  <article class="prose prose-lg dark:prose-invert max-w-none space-y-8" style="color: var(--color-text);">
    <div class="flex flex-col md:flex-row gap-8 items-start">
      <div class="space-y-6 flex-1">
        <h1 style="color: var(--color-text-heading);">About</h1>

        <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
          Software engineer and founder based in Northern Ireland. I build web applications and AI products,
          working with startups and established companies.
        </p>
      </div>

      <div class="flex-shrink-0 w-48 h-48 md:w-64 md:h-64">
        <img src="/profile.svg" alt="Profile" class="w-full h-full animate-float" style="filter: drop-shadow(0 10px 30px rgba(0,0,0,0.1));" />
      </div>
    </div>

    <div class="space-y-4">
      <h2 style="color: var(--color-text-heading);">Background</h2>
      <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
        I've spent my career building software across various domains - from early-stage startups to established
        enterprises. My focus is on creating practical, maintainable systems that solve real problems.
      </p>
      <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
        Currently working with FastAPI, Svelte, and distributed systems. I enjoy the challenge of building
        AI products for regulated environments where reliability and compliance are paramount. I work with
        tools like Ollama for local LLM deployment, FastMCP for building Model Context Protocol servers,
        and RAG systems for grounding AI responses in real data.
      </p>
    </div>

    <div class="space-y-4">
      <h2 style="color: var(--color-text-heading);">Interests</h2>
      <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
        Outside of work, I'm a keen gardener, enjoy reading fiction, and value time spent with family.
        I have a love/hate relationship with golf - mostly hate when I'm playing, mostly love when I'm not.
      </p>
      <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
        I watch a lot of TV and feel absolutely no guilt about it. Good storytelling is good storytelling,
        regardless of the medium.
      </p>
      <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
        I <a href="/writing" style="color: var(--color-accent);">write</a> about software, systems, and whatever else interests me.
        My <a href="/notes" style="color: var(--color-accent);">notes</a> are handy snippets and things I've learned.
        <a href="/thoughts" style="color: var(--color-accent);">Thoughts</a> are random things that pop into my head -
        politics, favourite ice cream, whatever comes first. I don't use social media for this because the world is fucked.
      </p>
      <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
        For what I'm currently working on, see my <a href="/now" style="color: var(--color-accent);">/now page</a>.
      </p>
    </div>

    <div class="space-y-6">
      <h2 style="color: var(--color-text-heading);">Get in Touch</h2>
      <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.8;">
        Have a question or want to work together? Drop me a message.
      </p>

      <form id="contact-form" class="space-y-5">
        <div>
          <label for="name" class="block text-sm font-medium mb-2" style="color: var(--color-text-heading);">
            Name
          </label>
          <input
            type="text"
            id="name"
            name="name"
            class="contact-input w-full px-4 py-3 rounded-lg border transition-all duration-200 focus:outline-none focus:ring-2"
            style="background: var(--color-surface); border-color: var(--color-border); color: var(--color-text);"
          />
          <p id="name-error" class="mt-1 text-sm text-red-500 hidden"></p>
        </div>

        <div>
          <label for="email" class="block text-sm font-medium mb-2" style="color: var(--color-text-heading);">
            Email
          </label>
          <input
            type="email"
            id="email"
            name="email"
            class="contact-input w-full px-4 py-3 rounded-lg border transition-all duration-200 focus:outline-none focus:ring-2"
            style="background: var(--color-surface); border-color: var(--color-border); color: var(--color-text);"
          />
          <p id="email-error" class="mt-1 text-sm text-red-500 hidden"></p>
        </div>

        <div>
          <label for="message" class="block text-sm font-medium mb-2" style="color: var(--color-text-heading);">
            Message
          </label>
          <textarea
            id="message"
            name="message"
            rows="5"
            class="contact-input w-full px-4 py-3 rounded-lg border transition-all duration-200 focus:outline-none focus:ring-2 resize-none"
            style="background: var(--color-surface); border-color: var(--color-border); color: var(--color-text);"
          ></textarea>
          <p id="message-error" class="mt-1 text-sm text-red-500 hidden"></p>
        </div>

        <p id="form-error" class="text-sm text-red-500 hidden"></p>

        <button
          type="submit"
          id="submit-btn"
          class="px-6 py-3 rounded-lg font-medium transition-all duration-200 hover:scale-[1.02] active:scale-[0.98]"
          style="background: var(--color-accent); color: white;"
        >
          Send message
        </button>
      </form>

      <div id="success-message" class="hidden p-6 rounded-lg text-center" style="background: var(--color-surface);">
        <p class="text-lg font-medium" style="color: var(--color-text-heading);">Message sent!</p>
        <p class="mt-2" style="color: var(--color-text);">Thanks for reaching out. I'll get back to you soon.</p>
      </div>
    </div>
  </article>

  <script>
    document.addEventListener('astro:page-load', () => {
      const form = document.getElementById('contact-form') as HTMLFormElement;
      const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
      const successMessage = document.getElementById('success-message');

      if (!form) return;

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        // Clear previous errors
        document.querySelectorAll('[id$="-error"]').forEach(el => {
          el.classList.add('hidden');
          el.textContent = '';
        });
        document.querySelectorAll('.contact-input').forEach(el => {
          el.classList.remove('border-red-500');
        });

        submitBtn.disabled = true;
        submitBtn.textContent = 'Sending...';

        try {
          const formData = new FormData(form);
          const response = await fetch('/api/contact', {
            method: 'POST',
            body: formData,
          });

          const result = await response.json();

          if (result.success) {
            form.classList.add('hidden');
            successMessage?.classList.remove('hidden');
          } else if (result.errors) {
            // Show field errors
            Object.entries(result.errors).forEach(([field, message]) => {
              const errorEl = document.getElementById(`${field}-error`);
              const inputEl = document.getElementById(field);
              if (errorEl && message) {
                errorEl.textContent = message as string;
                errorEl.classList.remove('hidden');
              }
              if (inputEl) {
                inputEl.classList.add('border-red-500');
              }
            });

            // Restore values
            if (result.values) {
              Object.entries(result.values).forEach(([field, value]) => {
                const inputEl = document.getElementById(field) as HTMLInputElement | HTMLTextAreaElement;
                if (inputEl && value) {
                  inputEl.value = value as string;
                }
              });
            }
          } else if (result.error) {
            const formError = document.getElementById('form-error');
            if (formError) {
              formError.textContent = result.error;
              formError.classList.remove('hidden');
            }
          }
        } catch (error) {
          const formError = document.getElementById('form-error');
          if (formError) {
            formError.textContent = 'Something went wrong. Please try again.';
            formError.classList.remove('hidden');
          }
        } finally {
          submitBtn.disabled = false;
          submitBtn.textContent = 'Send message';
        }
      });
    });
  </script>

  <style>
    @keyframes float {
      0%, 100% {
        transform: translateY(0px) rotate(0deg);
      }
      25% {
        transform: translateY(-10px) rotate(2deg);
      }
      50% {
        transform: translateY(-5px) rotate(-1deg);
      }
      75% {
        transform: translateY(-12px) rotate(1deg);
      }
    }

    .animate-float {
      animation: float 6s ease-in-out infinite;
    }

    article :global(h2),
    article :global(h3),
    article :global(h4) {
      color: var(--color-text-heading);
      font-family: 'Space Grotesk', sans-serif;
      margin-top: 0;
    }

    article :global(p) {
      color: var(--color-text);
      margin-bottom: 1.5rem;
      line-height: 1.8;
    }

    article :global(a) {
      color: var(--color-accent);
    }

    article :global(a:hover) {
      color: var(--color-accent-hover);
    }

    article :global(strong) {
      color: var(--color-text-heading);
    }

    article :global(code) {
      background-color: var(--color-surface);
      color: var(--color-accent-purple);
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-size: 0.9em;
    }

    .contact-input:focus {
      border-color: var(--color-accent) !important;
      ring-color: var(--color-accent);
      box-shadow: 0 0 0 3px rgba(var(--color-accent-rgb, 99, 102, 241), 0.1);
    }

    .contact-input::placeholder {
      color: var(--color-text-muted);
    }

    #submit-btn:hover {
      filter: brightness(1.1);
    }

    #submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .border-red-500 {
      border-color: #ef4444 !important;
    }

    .text-red-500 {
      color: #ef4444;
    }
  </style>
</BaseLayout>
